---
title: "PAMdemic: Plague Malware Leads to Linux Backdoor"
date: 2025-10-25 07:48:00 +0000
categories: [Writeups, Malware]
tags: [malware, linux]
description: "Analysis of Plague, a PAM-based Linux backdoor enabling stealthy SSH access and persistent authentication bypass."
---

# IN-PROGRESS
## Side-Bar
Throughout history, plagues have caused widespread devastation and left lasting effects on societies. Some plagues announce themselves through obvious harm, while others spread quietly, causing damage before detection. Similarly, malware can infiltrate digital systems unnoticed, wreaking havoc before anyone realizes it.

## Background
**Plague** represents a newly identified **Linux backdoor** that has quietly evaded detection by traditional antivirus solutions for **over a year**.  
Its primary mechanism involves operating as a **malicious PAM (Pluggable Authentication Module)**, allowing attackers to silently bypass system authentication and establish persistent SSH access to compromised Linux systems.

### How does PAM work?
If you are not familar with PAM and how PAM modules can be written to provide authetication, I recommend you check out this [blog post](https://www.redhat.com/en/blog/pluggable-authentication-modules-pam). In short, PAM separates the standard and specialized tasks of authentication from applications. On Linux OS's PAM components can be found in the following directories: 

Collection of PAM libraries that perform various checks.
```
/usr/lib64/security/
```
Collection of configuration files for applications that call libpam. Define which modules are checked, with what options, in which order and how the result is handled.
```
/etc/pam.d
```
Collection of additional configuration files for specific modules surrounding security features/checks.
```
/etc/security

```


---

### Infection

- Plague’s initial infection vector remains **unknown**.  
  However, during deployment, the malware drops a **binary** configured to run as a **PAM module for `sshd`**.
- This module provides an **SSH backdoor**, enabling threat actors to log in to the infected machine **without standard authentication**.
- Because it operates within the **core of Linux authentication**, the malware can **persist through application updates and security patches**.

---

### Detection Techniques
Lock down PAM & monitor file integrity surrounding these config files, hunt the session tampering, detect obfuscated loaders & anti-debug cues.

MITRE ATT&CK Technique- T1556.003 – Modify Authentication Process: Pluggable Authentication Modules

---
### Plague Analysis
The Plague sample used various features: Static credentials to allow covert access, resist analysis and reverse engineering using anti-debugging and string obfuscation; and enhanced stealth by erasing evidence of an SSH session. Additionally, the sample unset environment variables like ssh_connection & ssh_client while redirecting the HISTFILE to /dev/null<sub>[1]</sub>.

---

### Summary

Plague’s deep integration with PAM makes it particularly stealthy and durable.  
Its ability to bypass authentication and persist across updates highlights the importance of **PAM auditing** and **system integrity monitoring** in Linux environments.

---

### Resources

[1] https://thehackernews.com/2025/08/new-plague-pam-backdoor-exposes.html

